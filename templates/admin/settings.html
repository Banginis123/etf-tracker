<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ETF Settings</title>
    <style>
        body { font-family: sans-serif; padding: 10px; }
        .card { border: 1px solid #ccc; border-radius: 8px; padding: 12px; margin-bottom: 12px; }
        .danger { color: red; }
        .ok { color: green; }
    </style>
</head>
<body>

<h2>âš™ï¸ ETF Settings</h2>
<a href="/admin">â¬…ï¸ Portfolio</a>

<form method="post" action="/admin/etfs/add">
    <input type="text" name="ticker" placeholder="Ticker (pvz. VOO)" required>
    <button type="submit">â• Add ETF</button>
</form>

<hr>

{% for etf in etfs %}
<div class="card">
    <b>{{ etf.ticker }}</b><br><br>

    ATH: {{ "%.2f"|format(etf.ath_price) if etf.ath_price else "â€”" }}<br>
    Current: {{ "%.2f"|format(etf.current_price) if etf.current_price else "â€”" }}<br>
    Drop: {{ "%.2f"|format(etf.drop_percent) ~ " %" if etf.drop_percent is not none else "â€”" }}<br><br>

    <form method="post" action="/admin/etfs/{{ etf.id }}/update-threshold">
        Threshold (%):<br>
        <input type="number" step="0.1" name="drop_threshold_percent"
               value="{{ etf.drop_threshold_percent }}">
        <button type="submit">ğŸ’¾ Save</button>
    </form>

    <br>
    Alert sent:
    {% if etf.ath_alert_sent %}
        <span class="danger">YES</span>
    {% else %}
        <span class="ok">NO</span>
    {% endif %}

    <form method="post" action="/admin/etfs/{{ etf.id }}/reset-alert">
        <button type="submit">ğŸ” Reset alert</button>
    </form>

    <form method="post" action="/admin/etfs/{{ etf.id }}/delete"
          onsubmit="return confirm('Tikrai iÅ¡trinti {{ etf.ticker }}?');">
        <button type="submit">ğŸ—‘ï¸ Delete ETF</button>
    </form>
</div>
{% endfor %}

</body>
</html>
